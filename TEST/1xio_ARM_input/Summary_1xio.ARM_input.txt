 Local current time : Tue May 29 15:40:27 2018

----------------------------------------------------------------------------------------------------
**************** Welcome to the interface for the automatic preparation of the ARM input file ****************
Laura Pedraza-González, Luca De Vico, Federico Melaccio, Prof. Massimo Olivucci. 
 Laboratory for Computational Photochemistry and Photobiology (LCPP), University of Siena  - 2018
---------------------------------------------------------------------------------------------------- 

____________________________________________________________________________________________________
--------------- 1. Download a crystal structure -PDB file- from the RCSB Protein Data Bank 
-------- ---> This step uses the https://www.rcsb.org/ web page 
 (Berman, H. M. Nucleic Acids Res., (2000), 28, 235–242.)
____________________________________________________________________________________________________

 Do you want to download the PDB file from the RCSB Protein Data Bank webpage? [y/n] y
<-> Introduce the pdbID (i.e. 1u19):  1xio

.........................................Verifying that the requested PDB file is on the RSCB server
............................. Downloading the pdb file

 ---> The 1xio.pdb file is now in your folder. 
<--- TITLE     ANABAENA SENSORY RHODOPSIN                                            

____________________________________________________________________________________________________
--------------- 2. Selection of the PDB file--------------------------------------------------------  
____________________________________________________________________________________________________

 The following pdb files are found: 

1) 1xio.pdb

 To select the correct option pick a number in range 1-1:	1

 ---> The 1xio.pdb file will be used for preparing the ARM input file.
cp: *seqmut: No such file or directory
____________________________________________________________________________________________________
--------------- 3. Search and selection of the Chain------------------------------------------------  
____________________________________________________________________________________________________

 The following are identified as possible chain in the 1xio.pdb file:
1) A

 To select the correct option pick a number in range 1-1:	1

 ---> The A is selected as the chain
____________________________________________________________________________________________________
--------------- 4. Find the residue(s) with different rotamers and select the correct one(s)--------  
____________________________________________________________________________________________________

 The following are identified as possible rotamer in the 1xio.pdb file:
1) ALYS 210
2) ARET 301
3) BLYS 210
4) BRET 301

 Please check the 1xio.pdb file to select the rotamer you think better fits your structure. 

 <-> Do you want to keep the residue ALYS 210? [y/n] n
---> The ALYS 210 rotamer will be DELETED

 <-> Do you want to keep the residue ARET 301? [y/n] y
---> The ARET 301 rotamer will be KEEPED. Its new label is:  RET 301

 <-> Do you want to keep the residue BLYS 210? [y/n] y
---> The BLYS 210 rotamer will be KEEPED. Its new label is:  LYS 210

 <-> Do you want to keep the residue BRET 301? [y/n] n
---> The BRET 301 rotamer will be DELETED
____________________________________________________________________________________________________
--------------- 5. Search and selection of the Chromophore------------------------------------------  
____________________________________________________________________________________________________

 The following are identified as possible chromophore in the 1xio.pdb file:
1) RET 301

 To select the correct option pick a number in range 1-1:	1

 ---> The RET is selected as the chromophore
____________________________________________________________________________________________________
--------------- 6. Center the whole protein+chromophore on the center of mass of the whole complex-- 
 Luca De Vico & Laura Pedraza-González. 
---> This step uses the VMD - Visual Molecular Dynamics software 
 (Humphrey, W., Dalke, A. and Schulten, K., J. Molec. Graphics, (1996), 14, 33-38.)
____________________________________________________________________________________________________

......................................Centering the protein+RET on the center of mass of the complex
...............................................................................................Done!

 ---> The chromophore label has been changed to:  RET 227

 <-> Type the Residue sequence number of the main counterion:	75
---> The residue you selected as main counterion is: 75
 Are you sure about your selection? [y/n] y

 ---> The linker atom of RET is C20. The linker amino acid is LYS 210 and the main counterion is ASP 75

 ----> The 1xio.ARM.pdb ARM input file has been generated.
____________________________________________________________________________________________________
--------------- 7. Analysis of the amino acid ionization states:
 pKa analysis using the "PROPKA3.1: A PROTEIN PKA PREDICTOR" software 
 Luca De Vico & Laura Pedraza-González. 
---> This step uses the PROPKA3 software. 
 (Olsson, M. H., Søndergaard, C. R., Rostkowski, M., and Jensen, J. H., JCTC, (2011), 7(2), 525-537.)
____________________________________________________________________________________________________

............................Running PROPKA3.0 analysis for the 1xio.ARM.pdb input file
Done! The files 1xio.ARM.propka_input and 1xio.ARM.pka has been generated. 

<-> Please write the pH-value (suggested value physiological pH 7.4) in the range 0-14.0:	7.4

 ---> At pH  7.4 the predicted charge of the residues is: 
________________________________________
 RESIDUE CHARGE  pKa  (pKa - pKa-model)
________________________________________
ASP  57   -1    3.92        0.12   
ASP  98   -1    1.72        2.08   
ASP 120   -1    3.62        0.18   
ASP 125   -1    3.91        0.11   
ASP 166   -1    1.35        2.45   
ASP 198   -1    6.13        2.33   
ASP 217   -1    6.72        2.92   
ASP 226   -1    3.02        0.78   
GLU   4   -1    3.57        0.93   
GLU  36    0    7.82        3.32   
GLU 123   -1    4.57        0.07   
GLU 160   -1    4.16        0.34   
HIS   8    0    4.03        2.47   
HIS  21    0    5.50        1.00   
HIS  69    0    4.72        1.78   
HIS 219    0    4.92        1.58   
LYS  96    1    10.45       0.05   
LYS  97    1    9.39        1.11   
LYS 153    1    11.03       0.53   
LYS 167    1    10.22       0.28   
 N+   1    1    7.87        0.13   

 Based on the computed charges, the suggested residues to be protonated are: ionizable residue 
1) GLU  36    0
2) HIS   8    0
3) HIS  69    0
Warning:  Check carefully if HIS residues must be protonated!
Warning: The linker amino acid LYS 210 and the main counterion ASP 75 have been excluded from this analysis
____________________________________________________________________________________________________
--------------- 8. Change the ionization state of selected amino acids------------------------------ 
____________________________________________________________________________________________________

 <-> Based on the computed charges and the experimental information, do you want to change 
 the ionization state of any amino acid? (ASP --> ASH, GLU --> GLH, HIS --> (HID or HIE or HIP), LYS --> LYD) [y/n] y

 <-> Introduce the NUMBER ID of the residues, separated by space " " (i.e. 1 2 3):  36 8 69
---> The residues you selected are: {'8': 'HIS', '36': 'GLU', '69': 'HIS'}
 Are you sure about your selection? [y/n] y


******************************************************************************** 
Warning: Remember that: 
 HID: Histidine with hydrogen on the delta nitrogen 
 HIE: Histidine with hydrogen on the epsilon nitrogen 
 HIP: Histidine with hydrogens on both nitrogens; this is positively charged. 
******************************************************************************** 


 <-> Please select the correct ionization state of the residue HIS 8:

 Choose the  HIS protonation state.
1) HIE
2) HID
3) HIP

 To select the correct option pick a number in range 1-3:	2

 ---> The HID is the new protonation state.

 ---> The protonation state of the residue GLU 36 has been changed to GLH 


 <-> Please select the correct ionization state of the residue HIS 69:

 Choose the  HIS protonation state.
1) HIE
2) HID
3) HIP

 To select the correct option pick a number in range 1-3:	2

 ---> The HID is the new protonation state.
____________________________________________________________________________________________________
--------------- 9. Calculation of the number of counterions (Cl- and Na+) needed to neutralize the system 
____________________________________________________________________________________________________
----------------------------- 
 Summary 
-----------------------------
HIS	21	TOP	7.882
ARG	27	TOP	16.406
ARG	30	TOP	21.023
ARG	72	BOTTOM	-12.025
LYS	96	TOP	18.656
LYS	97	TOP	14.925
ARG	124	BOTTOM	-27.61
ARG	128	BOTTOM	-21.736
ARG	151	TOP	10.858
LYS	153	TOP	14.952
ARG	155	TOP	17.783
LYS	167	TOP	9.27
LYS	210	BOTTOM	0.0
HIS	219	TOP	13.394
ARG	222	TOP	18.009
_____________________________ 
 topPositive= 11
bottomPositive= 4 

GLU		4 BOTTOM	-17.703
ASP		57		BOTTOM	-18.943
ASP		75		BOTTOM	-7.578
ASP		98		TOP	12.835
ASP		120		BOTTOM	-20.036
GLU		123		BOTTOM	-27.32
ASP		125		BOTTOM	-26.14
GLU		160		TOP	20.26
ASP		166		TOP	10.452
ASP		198		BOTTOM	-17.118
ASP		217		TOP	10.085
ASP		226		TOP	24.013
_____________________________ 
 topNegative= 5
bottomNegative= 7 

Number of positively charged residues:	15
Number of negatively charged residues: 	12
----------------------------- 
Total charge top: 	      6		|  Suggestion: Add to the top  6 CL
----------------------------- 
Total charge bottom: 	      -3	|  Suggestion: Add to the bottom 3 NA
-----------------------------
____________________________________________________________________________________________________
--------------- 10. Add the counterions to the inner and outer layer of the proteins---------------- 
 Luca De Vico & Laura Pedraza-González.
____________________________________________________________________________________________________

--------------------------
PDB2PQR - a Python-based structural conversion utility
--------------------------
Please cite your use of PDB2PQR as:
  Dolinsky TJ, Nielsen JE, McCammon JA, Baker NA.
  PDB2PQR: an automated pipeline for the setup, execution,
  and analysis of Poisson-Boltzmann electrostatics calculations.
  Nucleic Acids Research 32 W665-W667 (2004).

The  1xio.ARM.pqr file has been generated and is ready to be used in the putIon module.

 ---> Running PutIon analysis over the 1xio.ARM.pqr file for the placement of the counterions
---> The following coordinates for the  CL and NA  counterions have been added to the  1xio.ARM.pdb file: 

HETATM 1882  CL   CL A 308      12.904  -9.119  26.761
HETATM 1883  CL   CL A 309      -4.773  15.824  26.070
HETATM 1884  CL   CL A 310      10.693  -0.266  24.194
HETATM 1885  CL   CL A 311     -10.965   4.568  20.269
HETATM 1886  CL   CL A 312      12.679  18.984  23.796
HETATM 1887  CL   CL A 313     -12.045 -10.504  19.165
HETATM 1888  NA   NA A 314      -2.134  -3.869 -18.278
HETATM 1889  NA   NA A 315      -0.020   4.435 -10.874
HETATM 1890  NA   NA A 316       9.624  -3.576 -23.492
____________________________________________________________________________________________________
--------------- 11. Definiton of the RET chromophore cavity using fpocket--------------------------- 
---> This step uses the fpocket software. 
 (Le Guilloux, V., Schmidtke, P. and Tuffery, P. BMC Bioinformatics, (2009), 10(1), 168)
____________________________________________________________________________________________________

 <-> Do you want to calculate the chromophore cavity?  [y/n] y
***** POCKET HUNTING BEGINS ***** 
***** POCKET HUNTING ENDS ***** 

 The folder 1xio.ARM_out has been generated
---> The cavity file has been generated
____________________________________________________________________________________________________
--------------- 12. Preparation of mutants---------------------------------------------------------- 
---> This step uses the MODELLER 9.19 software. 
 (Webb, B. and Sali, A. Curr. Protoc. Bioinformatics (2014), 47, 5.6.1–32)
____________________________________________________________________________________________________

 <-> Do you want to perform mutations of the wild type 1xio.ARM.pdb file? [y/n] n
---> No mutations requested.
____________________________________________________________________________________________________
--------------- The 1xio.ARM.pdb file is ready to be used as input for the ARM protocol!   
____________________________________________________________________________________________________
Total excecution time (min): 1.87913784981
